using System.IO;
using Cursach_2._0;
using System.Text.Json;
using NUnit.Framework;

namespace Cursach.Test;

public class Tests
{
    // r=[1;2], z=[1;2] по 5 точек. краевые первые слева= 1 и справа= 2. функция u= r^2 
    [Test]
    public void GlobalGglobalMGlobalB()
    {
        var area = JsonSerializer.Deserialize<Area>(
            File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Area.json"))!;
        var boundary =
            JsonSerializer.Deserialize<BoundaryData>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Boundary.json"))!;
        var initial =
            JsonSerializer.Deserialize<Initial>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Initial.json"))!;
        var fem = new Fem(area, boundary, 1);
        var femTest = new Fem(area, boundary, initial, true,0,1);

        var expected = fem.Slae;
        var result = femTest.Slae;

        for (var i = 0; i < expected.A.Di.Length; i++)
        {
            Assert.AreEqual(result.GlobalG.Di[i] + result.GlobalM.Di[i], expected.A.Di[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Al.Length; i++)
        {
            Assert.AreEqual(result.GlobalG.Al[i] + result.GlobalM.Al[i], expected.A.Al[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Au.Length; i++)
        {
            Assert.AreEqual(result.GlobalG.Au[i] + result.GlobalM.Au[i], expected.A.Au[i], 1.0e-4);
        }

        for (var i = 0; i < expected.B.Length; i++)
        {
            Assert.AreEqual(result.B[i], expected.B[i], 1.0e-4);
        }
    }

    [Test]
    public void DoKraev()
    {
        var Di = new[]
        {
            0.649757, 2.23417, 1.55833, 2.72417, 1.87, 3.21417, 2.18167, 3.70417, 1.22024, 2.04903, 6.48667, 4.9,
            7.91333, 5.88, 9.34, 6.86, 10.7667, 3.83097, 1.29951, 4.46833, 3.11667, 5.44833, 3.74, 6.42833, 4.36333,
            7.40833, 2.44049, 2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34, 6.86, 10.7667, 3.83097, 1.29951, 4.46833,
            3.11667, 5.44833, 3.74, 6.42833, 4.36333, 7.40833, 2.44049, 2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34,
            6.86, 10.7667, 3.83097, 1.29951, 4.46833, 3.11667, 5.44833, 3.74, 6.42833, 4.36333, 7.40833, 2.44049,
            2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34, 6.86, 10.7667, 3.83097, 0.649757, 2.23417, 1.55833, 2.72417,
            1.87, 3.21417, 2.18167, 3.70417, 1.22024,
        };
        var Al = new[]
        {
            -0.221667, -0.0378125, -0.25625, -0.271528, -0.0462153, -0.306111, -0.321389, -0.0546181, -0.355972,
            -0.37125, -0.0630208, -0.405833, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333,
            0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472,
            -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306,
            -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847,
            -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.396128, -0.00208333, -2.10667, -0.0363976, 0.116528,
            -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653,
            -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611,
            -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472,
            -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028,
            0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778,
            -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073,
            -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365,
            0.212222, -0.0644358, 0.208073, -0.666111, -0.396128, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844,
            -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125,
            -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033,
            -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.396128,
            -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528,
            0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271,
            -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889,
            0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983,
            0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479,
            -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033,
            -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847,
            -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0644358, 0.208073, -0.666111, -0.396128, -0.126042,
            -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587,
            -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556,
            0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111,
            -1.95167, 0.208073, -0.666111, -0.396128, -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219,
            -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333,
            -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587,
            -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601,
            0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306,
            -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479,
            -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944,
            0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0644358,
            0.208073, -0.666111, -0.396128, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083,
            -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208,
            -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444,
            -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556,
            -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.396128, -0.00208333, -2.10667,
            -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389,
            -1.23083, -0.399653, -0.221667, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.0378125, -0.25625, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694,
            -0.488472, -0.271528, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333,
            -0.544028, 0.18033, -0.0462153, -0.306111, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292,
            -0.321389, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.0546181, -0.355972, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.37125,
            -0.0415365, 0.212222, -0.0644358, 0.208073, -0.666111, -0.396128, -0.0630208, -0.405833,
        };
        var Au = new[]
        {
            -0.221667, -0.0378125, -0.25625, -0.271528, -0.0462153, -0.306111, -0.321389, -0.0546181, -0.355972,
            -0.37125, -0.0630208, -0.405833, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333,
            0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472,
            -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306,
            -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847,
            -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.396128, -0.00208333, -2.10667, -0.0363976, 0.116528,
            -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653,
            -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611,
            -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472,
            -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028,
            0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778,
            -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073,
            -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365,
            0.212222, -0.0644358, 0.208073, -0.666111, -0.396128, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844,
            -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125,
            -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033,
            -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.396128,
            -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528,
            0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271,
            -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889,
            0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983,
            0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479,
            -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033,
            -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847,
            -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0644358, 0.208073, -0.666111, -0.396128, -0.126042,
            -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587,
            -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556,
            0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111,
            -1.95167, 0.208073, -0.666111, -0.396128, -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219,
            -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333,
            -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587,
            -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601,
            0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306,
            -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479,
            -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944,
            0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0644358,
            0.208073, -0.666111, -0.396128, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083,
            -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208,
            -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444,
            -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556,
            -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.396128, -0.00208333, -2.10667,
            -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389,
            -1.23083, -0.399653, -0.221667, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.0378125, -0.25625, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694,
            -0.488472, -0.271528, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333,
            -0.544028, 0.18033, -0.0462153, -0.306111, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292,
            -0.321389, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.0546181, -0.355972, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.37125,
            -0.0415365, 0.212222, -0.0644358, 0.208073, -0.666111, -0.396128, -0.0630208, -0.405833,
        };
        var Ig = new[]
        {
            0, 0, 1, 3, 4, 6, 7, 9, 10, 12, 15, 19, 26, 30, 37, 41, 48, 52, 57, 63, 70, 82, 89, 101, 108, 120, 127, 135,
            138, 142, 149, 153, 160, 164, 171, 175, 180, 186, 193, 205, 212, 224, 231, 243, 250, 258, 261, 265, 272,
            276, 283, 287, 294, 298, 303, 309, 316, 328, 335, 347, 354, 366, 373, 381, 384, 388, 395, 399, 406, 410,
            417, 421, 426, 432, 439, 451, 458, 470, 477, 489, 496, 504,
        };
        var Jg = new[]
        {
            0, 0, 1, 2, 2, 3, 4, 4, 5, 6, 6, 7, 0, 1, 2, 0, 1, 2, 9, 0, 1, 2, 3, 4, 9, 10, 2, 3, 4, 11, 2, 3, 4, 5, 6,
            11, 12, 4, 5, 6, 13, 4, 5, 6, 7, 8, 13, 14, 6, 7, 8, 15, 6, 7, 8, 15, 16, 0, 1, 2, 9, 10, 11, 0, 1, 2, 9,
            10, 11, 18, 0, 1, 2, 3, 4, 9, 10, 11, 12, 13, 18, 19, 2, 3, 4, 11, 12, 13, 20, 2, 3, 4, 5, 6, 11, 12, 13,
            14, 15, 20, 21, 4, 5, 6, 13, 14, 15, 22, 4, 5, 6, 7, 8, 13, 14, 15, 16, 17, 22, 23, 6, 7, 8, 15, 16, 17, 24,
            6, 7, 8, 15, 16, 17, 24, 25, 18, 19, 20, 18, 19, 20, 27, 18, 19, 20, 21, 22, 27, 28, 20, 21, 22, 29, 20, 21,
            22, 23, 24, 29, 30, 22, 23, 24, 31, 22, 23, 24, 25, 26, 31, 32, 24, 25, 26, 33, 24, 25, 26, 33, 34, 18, 19,
            20, 27, 28, 29, 18, 19, 20, 27, 28, 29, 36, 18, 19, 20, 21, 22, 27, 28, 29, 30, 31, 36, 37, 20, 21, 22, 29,
            30, 31, 38, 20, 21, 22, 23, 24, 29, 30, 31, 32, 33, 38, 39, 22, 23, 24, 31, 32, 33, 40, 22, 23, 24, 25, 26,
            31, 32, 33, 34, 35, 40, 41, 24, 25, 26, 33, 34, 35, 42, 24, 25, 26, 33, 34, 35, 42, 43, 36, 37, 38, 36, 37,
            38, 45, 36, 37, 38, 39, 40, 45, 46, 38, 39, 40, 47, 38, 39, 40, 41, 42, 47, 48, 40, 41, 42, 49, 40, 41, 42,
            43, 44, 49, 50, 42, 43, 44, 51, 42, 43, 44, 51, 52, 36, 37, 38, 45, 46, 47, 36, 37, 38, 45, 46, 47, 54, 36,
            37, 38, 39, 40, 45, 46, 47, 48, 49, 54, 55, 38, 39, 40, 47, 48, 49, 56, 38, 39, 40, 41, 42, 47, 48, 49, 50,
            51, 56, 57, 40, 41, 42, 49, 50, 51, 58, 40, 41, 42, 43, 44, 49, 50, 51, 52, 53, 58, 59, 42, 43, 44, 51, 52,
            53, 60, 42, 43, 44, 51, 52, 53, 60, 61, 54, 55, 56, 54, 55, 56, 63, 54, 55, 56, 57, 58, 63, 64, 56, 57, 58,
            65, 56, 57, 58, 59, 60, 65, 66, 58, 59, 60, 67, 58, 59, 60, 61, 62, 67, 68, 60, 61, 62, 69, 60, 61, 62, 69,
            70, 54, 55, 56, 63, 64, 65, 54, 55, 56, 63, 64, 65, 72, 54, 55, 56, 57, 58, 63, 64, 65, 66, 67, 72, 73, 56,
            57, 58, 65, 66, 67, 74, 56, 57, 58, 59, 60, 65, 66, 67, 68, 69, 74, 75, 58, 59, 60, 67, 68, 69, 76, 58, 59,
            60, 61, 62, 67, 68, 69, 70, 71, 76, 77, 60, 61, 62, 69, 70, 71, 78, 60, 61, 62, 69, 70, 71, 78, 79,
        };
        var B = new[]
        {
            0, 0.00184462, 0.00195312, 0.0061849, 0.00434028, 0.0113932, 0.00716146, 0.0174696, 0.00520833, 0,
            0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.0208333, 0, 0.00368924,
            0.00390625, 0.0123698, 0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.0104167, 0, 0.00737847, 0.0078125,
            0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.0208333, 0, 0.00368924, 0.00390625, 0.0123698,
            0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.0104167, 0, 0.00737847, 0.0078125, 0.0247396, 0.0173611,
            0.0455729, 0.0286458, 0.0698785, 0.0208333, 0, 0.00368924, 0.00390625, 0.0123698, 0.00868056, 0.0227865,
            0.0143229, 0.0349392, 0.0104167, 0, 0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458,
            0.0698785, 0.0208333, 0, 0.00184462, 0.00195312, 0.0061849, 0.00434028, 0.0113932, 0.00716146, 0.0174696,
            0.00520833,
        };
        var q = new[]
        {
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1,
        };

        bool isTimeShem = false;

        var expected = new Matrix(Di, Al, Au, Ig, Jg);

        var area = JsonSerializer.Deserialize<Area>(
            File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Area.json"))!;
        var boundary =
            JsonSerializer.Deserialize<BoundaryData>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Boundary.json"))!;
        var initial =
            JsonSerializer.Deserialize<Initial>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Initial.json"))!;
        var fem = new Fem(area, boundary, 1);

        var result = fem.Slae;

        for (var i = 0; i < expected.Di.Length; i++)
        {
            Assert.AreEqual(result.A.Di[i], expected.Di[i], 1.0e-4);
        }

        for (var i = 0; i < expected.Al.Length; i++)
        {
            Assert.AreEqual(result.A.Al[i], expected.Al[i], 1.0e-4);
        }

        for (var i = 0; i < expected.Au.Length; i++)
        {
            Assert.AreEqual(result.A.Au[i], expected.Au[i], 1.0e-4);
        }

        for (var i = 0; i < expected.Ig.Length; i++)
        {
            Assert.AreEqual(result.A.Ig[i], expected.Ig[i], 1.0e-4);
        }

        for (var i = 0; i < expected.Jg.Length; i++)
        {
            Assert.AreEqual(result.A.Jg[i], expected.Jg[i], 1.0e-4);
        }
    }

    [Test]
    public void DoReshenia()
    {
        var Di = new[]
        {
            0.649757, 2.23417, 1.55833, 2.72417, 1.87, 3.21417, 2.18167, 3.70417, 1.25358, 2.04903, 6.48667, 4.9,
            7.91333, 5.88, 9.34, 6.86, 10.7667, 3.96431, 1.29951, 4.46833, 3.11667, 5.44833, 3.74, 6.42833, 4.36333,
            7.40833, 2.50715, 2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34, 6.86, 10.7667, 3.96431, 1.29951, 4.46833,
            3.11667, 5.44833, 3.74, 6.42833, 4.36333, 7.40833, 2.50715, 2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34,
            6.86, 10.7667, 3.96431, 1.29951, 4.46833, 3.11667, 5.44833, 3.74, 6.42833, 4.36333, 7.40833, 2.50715,
            2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34, 6.86, 10.7667, 3.96431, 0.68309, 2.3675, 1.625, 2.8575, 1.93667,
            3.3475, 2.24833, 3.8375, 1.28691,
        };
        var Al = new[]
        {
            -0.221667, -0.0378125, -0.25625, -0.271528, -0.0462153, -0.306111, -0.321389, -0.0546181, -0.355972,
            -0.37125, -0.0630208, -0.405833, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333,
            0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472,
            -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306,
            -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847,
            -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528,
            -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653,
            -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611,
            -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472,
            -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028,
            0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778,
            -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073,
            -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365,
            0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844,
            -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125,
            -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033,
            -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462,
            -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528,
            0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271,
            -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889,
            0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983,
            0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479,
            -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033,
            -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847,
            -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042,
            -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587,
            -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556,
            0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111,
            -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219,
            -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333,
            -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587,
            -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601,
            0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306,
            -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479,
            -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944,
            0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691,
            0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083,
            -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208,
            -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444,
            -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556,
            -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667,
            -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389,
            -1.23083, -0.399653, -0.205, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.0461458, -0.239583, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694,
            -0.488472, -0.254861, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333,
            -0.544028, 0.18033, -0.0545486, -0.289444, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292,
            -0.304722, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.0629514, -0.339306, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.354583,
            -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.0713542, -0.389167,
        };
        var Au = new[]
        {
            -0.221667, -0.0378125, -0.25625, -0.271528, -0.0462153, -0.306111, -0.321389, -0.0546181, -0.355972,
            -0.37125, -0.0630208, -0.405833, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333,
            0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472,
            -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306,
            -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847,
            -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528,
            -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653,
            -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611,
            -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472,
            -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028,
            0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778,
            -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073,
            -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365,
            0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844,
            -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125,
            -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033,
            -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462,
            -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528,
            0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271,
            -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889,
            0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983,
            0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479,
            -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033,
            -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847,
            -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042,
            -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587,
            -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556,
            0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111,
            -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219,
            -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333,
            -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587,
            -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601,
            0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306,
            -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479,
            -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944,
            0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691,
            0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083,
            -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208,
            -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444,
            -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556,
            -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667,
            -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389,
            -1.23083, -0.399653, -0.205, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.0461458, -0.239583, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694,
            -0.488472, -0.254861, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333,
            -0.544028, 0.18033, -0.0545486, -0.289444, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292,
            -0.304722, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.0629514, -0.339306, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.354583,
            -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.0713542, -0.389167,
        };
        var Ig = new[]
        {
            0, 0, 1, 3, 4, 6, 7, 9, 10, 12, 15, 19, 26, 30, 37, 41, 48, 52, 57, 63, 70, 82, 89, 101, 108, 120, 127, 135,
            138, 142, 149, 153, 160, 164, 171, 175, 180, 186, 193, 205, 212, 224, 231, 243, 250, 258, 261, 265, 272,
            276, 283, 287, 294, 298, 303, 309, 316, 328, 335, 347, 354, 366, 373, 381, 384, 388, 395, 399, 406, 410,
            417, 421, 426, 432, 439, 451, 458, 470, 477, 489, 496, 504,
        };
        var Jg = new[]
        {
            0, 0, 1, 2, 2, 3, 4, 4, 5, 6, 6, 7, 0, 1, 2, 0, 1, 2, 9, 0, 1, 2, 3, 4, 9, 10, 2, 3, 4, 11, 2, 3, 4, 5, 6,
            11, 12, 4, 5, 6, 13, 4, 5, 6, 7, 8, 13, 14, 6, 7, 8, 15, 6, 7, 8, 15, 16, 0, 1, 2, 9, 10, 11, 0, 1, 2, 9,
            10, 11, 18, 0, 1, 2, 3, 4, 9, 10, 11, 12, 13, 18, 19, 2, 3, 4, 11, 12, 13, 20, 2, 3, 4, 5, 6, 11, 12, 13,
            14, 15, 20, 21, 4, 5, 6, 13, 14, 15, 22, 4, 5, 6, 7, 8, 13, 14, 15, 16, 17, 22, 23, 6, 7, 8, 15, 16, 17, 24,
            6, 7, 8, 15, 16, 17, 24, 25, 18, 19, 20, 18, 19, 20, 27, 18, 19, 20, 21, 22, 27, 28, 20, 21, 22, 29, 20, 21,
            22, 23, 24, 29, 30, 22, 23, 24, 31, 22, 23, 24, 25, 26, 31, 32, 24, 25, 26, 33, 24, 25, 26, 33, 34, 18, 19,
            20, 27, 28, 29, 18, 19, 20, 27, 28, 29, 36, 18, 19, 20, 21, 22, 27, 28, 29, 30, 31, 36, 37, 20, 21, 22, 29,
            30, 31, 38, 20, 21, 22, 23, 24, 29, 30, 31, 32, 33, 38, 39, 22, 23, 24, 31, 32, 33, 40, 22, 23, 24, 25, 26,
            31, 32, 33, 34, 35, 40, 41, 24, 25, 26, 33, 34, 35, 42, 24, 25, 26, 33, 34, 35, 42, 43, 36, 37, 38, 36, 37,
            38, 45, 36, 37, 38, 39, 40, 45, 46, 38, 39, 40, 47, 38, 39, 40, 41, 42, 47, 48, 40, 41, 42, 49, 40, 41, 42,
            43, 44, 49, 50, 42, 43, 44, 51, 42, 43, 44, 51, 52, 36, 37, 38, 45, 46, 47, 36, 37, 38, 45, 46, 47, 54, 36,
            37, 38, 39, 40, 45, 46, 47, 48, 49, 54, 55, 38, 39, 40, 47, 48, 49, 56, 38, 39, 40, 41, 42, 47, 48, 49, 50,
            51, 56, 57, 40, 41, 42, 49, 50, 51, 58, 40, 41, 42, 43, 44, 49, 50, 51, 52, 53, 58, 59, 42, 43, 44, 51, 52,
            53, 60, 42, 43, 44, 51, 52, 53, 60, 61, 54, 55, 56, 54, 55, 56, 63, 54, 55, 56, 57, 58, 63, 64, 56, 57, 58,
            65, 56, 57, 58, 59, 60, 65, 66, 58, 59, 60, 67, 58, 59, 60, 61, 62, 67, 68, 60, 61, 62, 69, 60, 61, 62, 69,
            70, 54, 55, 56, 63, 64, 65, 54, 55, 56, 63, 64, 65, 72, 54, 55, 56, 57, 58, 63, 64, 65, 66, 67, 72, 73, 56,
            57, 58, 65, 66, 67, 74, 56, 57, 58, 59, 60, 65, 66, 67, 68, 69, 74, 75, 58, 59, 60, 67, 68, 69, 76, 58, 59,
            60, 61, 62, 67, 68, 69, 70, 71, 76, 77, 60, 61, 62, 69, 70, 71, 78, 60, 61, 62, 69, 70, 71, 78, 79,
        };
        var B = new[]
        {
            -0.0416667, 0.00184462, 0.00195312, 0.0061849, 0.00434028, 0.0113932, 0.00716146, 0.0174696, 0.171875,
            -0.166667, 0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, -0.0833333,
            0.00368924, 0.00390625, 0.0123698, 0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.34375, -0.166667,
            0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, -0.0833333,
            0.00368924, 0.00390625, 0.0123698, 0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.34375, -0.166667,
            0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, -0.0833333,
            0.00368924, 0.00390625, 0.0123698, 0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.34375, -0.166667,
            0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, 0, 0.189345, 0.10612,
            0.235352, 0.12934, 0.282227, 0.152995, 0.32997, 0.255208,
        };
        double[] q = new double[]
        {
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1,
        };

        bool isTimeShem = false;

        var matrix = new Matrix(Di, Al, Au, Ig, Jg);
        var expected = new Slae(matrix, q, B);

        var area = JsonSerializer.Deserialize<Area>(
            File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Area.json"))!;
        var boundary =
            JsonSerializer.Deserialize<BoundaryData>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Boundary.json"))!;
        var initial =
            JsonSerializer.Deserialize<Initial>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Initial.json"))!;
        var fem = new Fem(area, boundary, 1);
        Boundary.Two(area, fem.Grid, boundary, ref fem.Slae, 0);
        Boundary.Three(area, fem.Grid, boundary, ref fem.Slae, 0);
        Boundary.One(area, fem.Grid, boundary, ref fem.Slae, 0, 1);

        var result = fem.Slae;

        for (var i = 0; i < expected.A.Di.Length; i++)
        {
            Assert.AreEqual(result.A.Di[i], expected.A.Di[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Al.Length; i++)
        {
            Assert.AreEqual(result.A.Al[i], expected.A.Al[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Au.Length; i++)
        {
            Assert.AreEqual(result.A.Au[i], expected.A.Au[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Ig.Length; i++)
        {
            Assert.AreEqual(result.A.Ig[i], expected.A.Ig[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Jg.Length; i++)
        {
            Assert.AreEqual(result.A.Jg[i], expected.A.Jg[i], 1.0e-4);
        }

        for (var i = 0; i < expected.B.Length; i++)
        {
            Assert.AreEqual(result.B[i], expected.B[i], 1.0e-4);
        }

        for (var i = 0; i < expected.Q.Length; i++)
        {
            Assert.AreEqual(result.Q[i], expected.Q[i], 1.0e-4);
        }
    }

    [Test]
    public void Facrotia()
    {
        var Di = new[]
        {
            0.806075, 1.4692, 1.23393, 1.63577, 1.35339, 1.77701, 1.46209, 1.9078, 1.09727, 1.37696, 1.99609, 1.95012,
            2.37934, 2.16132, 2.59061, 2.33468, 2.72261, 1.6231, 1.10179, 1.82952, 1.64831, 2.11648, 1.81936, 2.30283,
            1.96322, 2.38362, 1.43479, 1.39576, 2.12763, 2.02286, 2.50922, 2.23986, 2.73206, 2.41787, 2.84747, 1.70862,
            1.10688, 1.86332, 1.66248, 2.14324, 1.83199, 2.33087, 1.97719, 2.43045, 1.45263, 1.39715, 2.14347, 2.02981,
            2.51925, 2.24446, 2.74179, 2.42338, 2.87131, 1.72134, 1.10723, 1.86666, 1.66366, 2.14498, 1.83268, 2.33242,
            1.97829, 2.4368, 1.455, 1.39729, 2.14504, 2.03047, 2.51999, 2.24476, 2.74237, 2.42386, 2.87448, 1.72305,
            0.780778, 1.20759, 1.13522, 1.42984, 1.25616, 1.54878, 1.34992, 1.55135, 0.945053,
        };
        var Al = new[]
        {
            -0.274995, -0.0469094, -0.183195, -0.220052, -0.0374539, -0.192174, -0.237469, -0.0403565, -0.205714,
            -0.253917, -0.0431031, -0.21846, -0.250851, -0.296333, 0.0476445, -0.454534, -0.922835, -0.478176, -1.10246,
            0.154879, -0.243032, -0.434279, -0.336705, 0.0529155, -0.0099682, -0.842079, -0.368911, -0.964759,
            -0.508125, -0.962814, 0.12366, -0.281984, -0.478718, -0.37012, 0.0580481, -0.00894242, -0.862729, -0.401974,
            -1.04586, -0.553085, -1.03316, 0.133243, -0.307061, -0.51696, -0.40052, 0.0895795, -0.0100219, -0.928126,
            -0.432836, -1.12123, -0.847297, -1.09162, 0.142312, -0.330211, -0.405978, -0.0104523, -1.01766, -0.0451541,
            0.0708622, -0.0113933, -0.13943, -0.240812, -0.0307988, 0.144562, 0.0290434, 0.114346, -0.237456, -0.674032,
            -0.479601, -0.587912, -0.0309176, 0.0820113, -0.0570975, 0.0805165, -0.0126537, 0.104659, -0.125217,
            -0.29501, -0.289602, -0.0352526, -0.0981403, -0.416839, 0.11692, 0.0173419, 0.121508, -0.207691, -0.662076,
            -0.46866, -0.488846, -0.0246855, 0.0924971, -0.0620533, 0.088507, -0.0138811, 0.0904016, -0.14829,
            -0.320391, -0.314635, -0.0371068, -0.0786522, -0.411724, 0.127098, 0.0183134, 0.132259, -0.223976,
            -0.714527, -0.50784, -0.522214, -0.0265986, 0.10026, -0.067087, 0.0957766, -0.0214212, 0.0965149, -0.162323,
            -0.346007, -0.349061, -0.072881, -0.0844696, -0.441075, 0.136624, 0.0192758, 0.202615, -0.245278, -0.750932,
            -0.840178, -0.580202, -0.0284089, 0.107458, -0.0460401, 0.103033, -0.177939, -0.331854, -0.0967152,
            -0.521814, -0.183524, -0.259239, -0.000745271, -0.332539, -0.779622, -0.45942, -1.01509, 0.11331, -0.182035,
            -0.341787, -0.29402, 0.00255545, -0.0199893, -0.747257, -0.276167, -0.771065, -0.454918, -0.859863,
            0.0925718, -0.209413, -0.372259, -0.32066, 0.00379476, -0.0150818, -0.754283, -0.299022, -0.833413,
            -0.494162, -0.920697, 0.0991172, -0.228211, -0.402575, -0.36349, -0.0143131, -0.0163219, -0.810773,
            -0.322352, -0.92976, -0.824126, -1.00551, 0.105986, -0.253655, -0.349578, -0.0234177, -0.92011, -0.0330349,
            0.0530773, -0.0036639, -0.139358, -0.225198, -0.0168424, 0.105762, 0.0355806, 0.0935529, -0.241937,
            -0.644158, -0.424831, -0.566748, -0.0226194, 0.0632377, -0.0363328, 0.0597735, -0.00478605, 0.0981969,
            -0.129199, -0.283732, -0.265142, -0.0167802, -0.0903907, -0.397243, 0.0875266, 0.0214629, 0.09479,
            -0.207244, -0.634181, -0.418896, -0.46598, -0.0184796, 0.0697867, -0.0404285, 0.0655287, -0.00535353,
            0.0825034, -0.154317, -0.308581, -0.288522, -0.0172989, -0.0722726, -0.397519, 0.0945464, 0.0224656,
            0.103083, -0.224129, -0.685007, -0.454566, -0.499205, -0.0197862, 0.0756228, -0.0437827, 0.0731468,
            -0.00529825, 0.0881213, -0.168622, -0.333032, -0.322457, -0.0439417, -0.0777545, -0.426114, 0.10175,
            0.0256411, 0.164095, -0.23997, -0.729977, -0.755175, -0.550042, -0.0211573, 0.0838836, -0.0216364,
            0.0950162, -0.181646, -0.309264, -0.0878709, -0.493649, -0.182681, -0.252196, 0.00490104, -0.331012,
            -0.761239, -0.440287, -1.00464, 0.112789, -0.180178, -0.33684, -0.285628, 0.00802412, -0.0174891, -0.734339,
            -0.273812, -0.757981, -0.441908, -0.849649, 0.0917825, -0.207958, -0.368106, -0.312239, 0.00943697,
            -0.0133296, -0.746624, -0.296959, -0.819994, -0.480374, -0.91174, 0.0984337, -0.22659, -0.398016, -0.350458,
            6.56398e-05, -0.0145094, -0.802963, -0.320074, -0.907329, -0.786258, -0.989111, 0.105237, -0.250252,
            -0.339903, -0.0197568, -0.900925, -0.0328832, 0.0525359, -0.00422542, -0.139528, -0.223617, -0.0148071,
            0.105276, 0.0335861, 0.0913399, -0.242733, -0.641045, -0.418608, -0.564168, -0.0225155, 0.0623791,
            -0.0368625, 0.0592998, -0.0052137, 0.0978013, -0.129508, -0.282618, -0.263087, -0.0150645, -0.0896805,
            -0.394845, 0.0867804, 0.0200989, 0.0933397, -0.207401, -0.632298, -0.415579, -0.463909, -0.018322,
            0.0691469, -0.0407591, 0.0650687, -0.00578638, 0.0820235, -0.154569, -0.307965, -0.286798, -0.0156697,
            -0.0718547, -0.396393, 0.0938944, 0.0211224, 0.101548, -0.224476, -0.683399, -0.45116, -0.497597,
            -0.0196498, 0.0749376, -0.0441205, 0.0722041, -0.00672565, 0.087732, -0.168826, -0.332463, -0.318874,
            -0.0379651, -0.0773614, -0.42504, 0.101031, 0.0237217, 0.160268, -0.241123, -0.727121, -0.741385, -0.545344,
            -0.0210078, 0.0825636, -0.0233079, 0.0943509, -0.182121, -0.305997, -0.0866452, -0.488984, -0.182622,
            -0.251476, 0.0055133, -0.330905, -0.75939, -0.438292, -1.0036, 0.112753, -0.180023, -0.336355, -0.284966,
            0.0084356, -0.0172304, -0.733062, -0.273618, -0.757059, -0.441008, -0.848817, 0.0917175, -0.207891,
            -0.36785, -0.311723, 0.0097952, -0.0132073, -0.746102, -0.296849, -0.81922, -0.479433, -0.9112, 0.098397,
            -0.226516, -0.397678, -0.348703, 0.00213472, -0.0144002, -0.802478, -0.319896, -0.90431, -0.780769,
            -0.987084, 0.105178, -0.249817, -0.338491, -0.0192444, -0.898324, -0.0328726, 0.0524907, -0.00429427,
            -0.139545, -0.223462, -0.0146079, 0.105242, 0.0333704, 0.0911288, -0.242814, -0.640741, -0.418006,
            -0.494471, -0.0225083, 0.0623011, -0.0369348, 0.0592715, -0.00524871, 0.0977639, -0.129537, -0.282507,
            -0.262919, -0.014937, -0.0893285, -0.378812, 0.0867189, 0.0199855, 0.0932458, -0.207406, -0.632151,
            -0.415349, -0.42578, -0.0183091, 0.0691112, -0.0407894, 0.0650471, -0.00581622, 0.0819846, -0.154588,
            -0.307923, -0.286692, -0.0155674, -0.0718956, -0.366936, 0.0938594, 0.0210362, 0.101442, -0.224495,
            -0.683308, -0.450931, -0.456722, -0.0196425, 0.0749029, -0.04414, 0.0720969, -0.00694623, 0.087709,
            -0.168833, -0.332435, -0.318435, -0.0371898, -0.0759869, -0.396987, 0.100975, 0.0234526, 0.159752,
            -0.241291, -0.726776, -0.739573, -0.511037, -0.0209961, 0.0823918, -0.0235739, 0.0942728, -0.182179,
            -0.305558, -0.0862433, -0.493071,
        };
        var Au = new[]
        {
            -0.274995, -0.0469094, -0.183195, -0.220052, -0.0374539, -0.192174, -0.237469, -0.0403565, -0.205714,
            -0.253917, -0.0431031, -0.21846, -0.250851, -0.296333, 0.0476445, -0.454534, -0.922835, -0.478176, -1.10246,
            0.154879, -0.243032, -0.434279, -0.336705, 0.0529155, -0.0099682, -0.842079, -0.368911, -0.964759,
            -0.508125, -0.962814, 0.12366, -0.281984, -0.478718, -0.37012, 0.0580481, -0.00894242, -0.862729, -0.401974,
            -1.04586, -0.553085, -1.03316, 0.133243, -0.307061, -0.51696, -0.40052, 0.0895795, -0.0100219, -0.928126,
            -0.432836, -1.12123, -0.847297, -1.09162, 0.142312, -0.330211, -0.405978, -0.0104523, -1.01766, -0.0451541,
            0.0708622, -0.0113933, -0.13943, -0.240812, -0.0307988, 0.144562, 0.0290434, 0.114346, -0.237456, -0.674032,
            -0.479601, -0.587912, -0.0309176, 0.0820113, -0.0570975, 0.0805165, -0.0126537, 0.104659, -0.125217,
            -0.29501, -0.289602, -0.0352526, -0.0981403, -0.416839, 0.11692, 0.0173419, 0.121508, -0.207691, -0.662076,
            -0.46866, -0.488846, -0.0246855, 0.0924971, -0.0620533, 0.088507, -0.0138811, 0.0904016, -0.14829,
            -0.320391, -0.314635, -0.0371068, -0.0786522, -0.411724, 0.127098, 0.0183134, 0.132259, -0.223976,
            -0.714527, -0.50784, -0.522214, -0.0265986, 0.10026, -0.067087, 0.0957766, -0.0214212, 0.0965149, -0.162323,
            -0.346007, -0.349061, -0.072881, -0.0844696, -0.441075, 0.136624, 0.0192758, 0.202615, -0.245278, -0.750932,
            -0.840178, -0.580202, -0.0284089, 0.107458, -0.0460401, 0.103033, -0.177939, -0.331854, -0.0967152,
            -0.521814, -0.183524, -0.259239, -0.000745271, -0.332539, -0.779622, -0.45942, -1.01509, 0.11331, -0.182035,
            -0.341787, -0.29402, 0.00255545, -0.0199893, -0.747257, -0.276167, -0.771065, -0.454918, -0.859863,
            0.0925718, -0.209413, -0.372259, -0.32066, 0.00379476, -0.0150818, -0.754283, -0.299022, -0.833413,
            -0.494162, -0.920697, 0.0991172, -0.228211, -0.402575, -0.36349, -0.0143131, -0.0163219, -0.810773,
            -0.322352, -0.92976, -0.824126, -1.00551, 0.105986, -0.253655, -0.349578, -0.0234177, -0.92011, -0.0330349,
            0.0530773, -0.0036639, -0.139358, -0.225198, -0.0168424, 0.105762, 0.0355806, 0.0935529, -0.241937,
            -0.644158, -0.424831, -0.566748, -0.0226194, 0.0632377, -0.0363328, 0.0597735, -0.00478605, 0.0981969,
            -0.129199, -0.283732, -0.265142, -0.0167802, -0.0903907, -0.397243, 0.0875266, 0.0214629, 0.09479,
            -0.207244, -0.634181, -0.418896, -0.46598, -0.0184796, 0.0697867, -0.0404285, 0.0655287, -0.00535353,
            0.0825034, -0.154317, -0.308581, -0.288522, -0.0172989, -0.0722726, -0.397519, 0.0945464, 0.0224656,
            0.103083, -0.224129, -0.685007, -0.454566, -0.499205, -0.0197862, 0.0756228, -0.0437827, 0.0731468,
            -0.00529825, 0.0881213, -0.168622, -0.333032, -0.322457, -0.0439417, -0.0777545, -0.426114, 0.10175,
            0.0256411, 0.164095, -0.23997, -0.729977, -0.755175, -0.550042, -0.0211573, 0.0838836, -0.0216364,
            0.0950162, -0.181646, -0.309264, -0.0878709, -0.493649, -0.182681, -0.252196, 0.00490104, -0.331012,
            -0.761239, -0.440287, -1.00464, 0.112789, -0.180178, -0.33684, -0.285628, 0.00802412, -0.0174891, -0.734339,
            -0.273812, -0.757981, -0.441908, -0.849649, 0.0917825, -0.207958, -0.368106, -0.312239, 0.00943697,
            -0.0133296, -0.746624, -0.296959, -0.819994, -0.480374, -0.91174, 0.0984337, -0.22659, -0.398016, -0.350458,
            6.56398e-05, -0.0145094, -0.802963, -0.320074, -0.907329, -0.786258, -0.989111, 0.105237, -0.250252,
            -0.339903, -0.0197568, -0.900925, -0.0328832, 0.0525359, -0.00422542, -0.139528, -0.223617, -0.0148071,
            0.105276, 0.0335861, 0.0913399, -0.242733, -0.641045, -0.418608, -0.564168, -0.0225155, 0.0623791,
            -0.0368625, 0.0592998, -0.0052137, 0.0978013, -0.129508, -0.282618, -0.263087, -0.0150645, -0.0896805,
            -0.394845, 0.0867804, 0.0200989, 0.0933397, -0.207401, -0.632298, -0.415579, -0.463909, -0.018322,
            0.0691469, -0.0407591, 0.0650687, -0.00578638, 0.0820235, -0.154569, -0.307965, -0.286798, -0.0156697,
            -0.0718547, -0.396393, 0.0938944, 0.0211224, 0.101548, -0.224476, -0.683399, -0.45116, -0.497597,
            -0.0196498, 0.0749376, -0.0441205, 0.0722041, -0.00672565, 0.087732, -0.168826, -0.332463, -0.318874,
            -0.0379651, -0.0773614, -0.42504, 0.101031, 0.0237217, 0.160268, -0.241123, -0.727121, -0.741385, -0.545344,
            -0.0210078, 0.0825636, -0.0233079, 0.0943509, -0.182121, -0.305997, -0.0866452, -0.488984, -0.182622,
            -0.251476, 0.0055133, -0.330905, -0.75939, -0.438292, -1.0036, 0.112753, -0.180023, -0.336355, -0.284966,
            0.0084356, -0.0172304, -0.733062, -0.273618, -0.757059, -0.441008, -0.848817, 0.0917175, -0.207891,
            -0.36785, -0.311723, 0.0097952, -0.0132073, -0.746102, -0.296849, -0.81922, -0.479433, -0.9112, 0.098397,
            -0.226516, -0.397678, -0.348703, 0.00213472, -0.0144002, -0.802478, -0.319896, -0.90431, -0.780769,
            -0.987084, 0.105178, -0.249817, -0.338491, -0.0192444, -0.898324, -0.0328726, 0.0524907, -0.00429427,
            -0.139545, -0.223462, -0.0146079, 0.105242, 0.0333704, 0.0911288, -0.242814, -0.640741, -0.418006,
            -0.494471, -0.0225083, 0.0623011, -0.0369348, 0.0592715, -0.00524871, 0.0977639, -0.129537, -0.282507,
            -0.262919, -0.014937, -0.0893285, -0.378812, 0.0867189, 0.0199855, 0.0932458, -0.207406, -0.632151,
            -0.415349, -0.42578, -0.0183091, 0.0691112, -0.0407894, 0.0650471, -0.00581622, 0.0819846, -0.154588,
            -0.307923, -0.286692, -0.0155674, -0.0718956, -0.366936, 0.0938594, 0.0210362, 0.101442, -0.224495,
            -0.683308, -0.450931, -0.456722, -0.0196425, 0.0749029, -0.04414, 0.0720969, -0.00694623, 0.087709,
            -0.168833, -0.332435, -0.318435, -0.0371898, -0.0759869, -0.396987, 0.100975, 0.0234526, 0.159752,
            -0.241291, -0.726776, -0.739573, -0.511037, -0.0209961, 0.0823918, -0.0235739, 0.0942728, -0.182179,
            -0.305558, -0.0862433, -0.493071,
        };


        var Facos = new double[3][];
        Facos[0] = Di;
        Facos[1] = Al;
        Facos[2] = Au;
        var expected = Facos;
        bool isTimeShem = false;

        var area = JsonSerializer.Deserialize<Area>(
            File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Area.json"))!;
        var boundary =
            JsonSerializer.Deserialize<BoundaryData>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Boundary.json"))!;
        var initial =
            JsonSerializer.Deserialize<Initial>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Initial.json"))!;
        var fem = new Fem(area, boundary,1);
        Boundary.Two(area, fem.Grid, boundary, ref fem.Slae, 0);
        Boundary.Three(area, fem.Grid, boundary, ref fem.Slae, 0);
        Boundary.One(area, fem.Grid, boundary, ref fem.Slae, 0,1);
        var Fac = new double[3][];
        Fac[0] = new double[fem.Slae.A.Di.Length];
        Fac[1] = new double[fem.Slae.A.Al.Length];
        Fac[2] = new double[fem.Slae.A.Au.Length];
        fem.Slae.LUsq(Fac[0], Fac[1], Fac[2]);

        var result = Fac;

        for (var i = 0; i < expected[0].Length; i++)
        {
            Assert.AreEqual(result[0][i], expected[0][i], 1.0e-4);
        }

        for (var i = 0; i < expected[1].Length; i++)
        {
            Assert.AreEqual(result[1][i], expected[1][i], 1.0e-4);
        }

        for (var i = 0; i < expected[2].Length; i++)
        {
            Assert.AreEqual(result[2][i], expected[2][i], 1.0e-4);
        }
    }

    [Test]
    public void PosleReshenia()
    {
        var Di = new[]
        {
            0.649757, 2.23417, 1.55833, 2.72417, 1.87, 3.21417, 2.18167, 3.70417, 1.25358, 2.04903, 6.48667, 4.9,
            7.91333, 5.88, 9.34, 6.86, 10.7667, 3.96431, 1.29951, 4.46833, 3.11667, 5.44833, 3.74, 6.42833, 4.36333,
            7.40833, 2.50715, 2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34, 6.86, 10.7667, 3.96431, 1.29951, 4.46833,
            3.11667, 5.44833, 3.74, 6.42833, 4.36333, 7.40833, 2.50715, 2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34,
            6.86, 10.7667, 3.96431, 1.29951, 4.46833, 3.11667, 5.44833, 3.74, 6.42833, 4.36333, 7.40833, 2.50715,
            2.04903, 6.48667, 4.9, 7.91333, 5.88, 9.34, 6.86, 10.7667, 3.96431, 0.68309, 2.3675, 1.625, 2.8575, 1.93667,
            3.3475, 2.24833, 3.8375, 1.28691,
        };
        var Al = new[]
        {
            -0.221667, -0.0378125, -0.25625, -0.271528, -0.0462153, -0.306111, -0.321389, -0.0546181, -0.355972,
            -0.37125, -0.0630208, -0.405833, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333,
            0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472,
            -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306,
            -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847,
            -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528,
            -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653,
            -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611,
            -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472,
            -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028,
            0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778,
            -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073,
            -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365,
            0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844,
            -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125,
            -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033,
            -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462,
            -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528,
            0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271,
            -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889,
            0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983,
            0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479,
            -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033,
            -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847,
            -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042,
            -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587,
            -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556,
            0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111,
            -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219,
            -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333,
            -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587,
            -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601,
            0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306,
            -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479,
            -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944,
            0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691,
            0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083,
            -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208,
            -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444,
            -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556,
            -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667,
            -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389,
            -1.23083, -0.399653, -0.205, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.0461458, -0.239583, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694,
            -0.488472, -0.254861, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333,
            -0.544028, 0.18033, -0.0545486, -0.289444, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292,
            -0.304722, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.0629514, -0.339306, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.354583,
            -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.0713542, -0.389167,
        };
        var Au = new[]
        {
            -0.221667, -0.0378125, -0.25625, -0.271528, -0.0462153, -0.306111, -0.321389, -0.0546181, -0.355972,
            -0.37125, -0.0630208, -0.405833, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333,
            0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472,
            -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306,
            -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847,
            -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528,
            -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653,
            -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611,
            -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472,
            -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028,
            0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778,
            -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073,
            -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365,
            0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844,
            -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125,
            -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033,
            -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462,
            -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528,
            0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333, -0.0249219, 0.128993, -0.0840278, 0.144271,
            -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.075625, -0.5125, 0.144271, 0.00263889,
            0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983,
            0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306, -0.612222, 0.172014, 0.00236111, 0.184479,
            -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033,
            -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944, 0.199757, 0.00208333, 0.212222, -0.632847,
            -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.126042,
            -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083, -0.399653, -1.15333, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208, -1.49694, -0.488472, -1.41944, 0.152587,
            -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444, -0.544028, -1.76306, -0.577292, -1.68556,
            0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556, -1.84056, -0.632847, -2.02917, -0.666111,
            -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667, -0.0363976, 0.116528, -0.0249219,
            -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389, -1.23083, -0.399653, -0.443333,
            -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587,
            -0.075625, -0.5125, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694, -0.488472, -0.543056, -0.0304601,
            0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.0924306,
            -0.612222, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292, -0.642778, -0.0359983, 0.184479,
            -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.109236, -0.711944,
            0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.7425, -0.0415365, 0.212222, -0.0727691,
            0.208073, -0.666111, -0.379462, -0.126042, -0.811667, -0.202205, -0.366389, 0.124844, -0.366389, -1.23083,
            -0.399653, -1.15333, 0.124844, -0.399653, -0.498611, -0.455208, 0.152587, -0.00125, -1.30833, -0.455208,
            -1.49694, -0.488472, -1.41944, 0.152587, -0.488472, -0.598333, -0.544028, 0.18033, -0.00152778, -1.57444,
            -0.544028, -1.76306, -0.577292, -1.68556, 0.18033, -0.577292, -0.698056, -0.632847, 0.208073, -0.00180556,
            -1.84056, -0.632847, -2.02917, -0.666111, -1.95167, 0.208073, -0.666111, -0.379462, -0.00208333, -2.10667,
            -0.0363976, 0.116528, -0.0249219, -0.202205, -0.366389, 0.124844, 0.116528, 0.00291667, 0.128993, -0.366389,
            -1.23083, -0.399653, -0.205, -0.0249219, 0.128993, -0.0840278, 0.144271, -0.0304601, 0.124844, -0.399653,
            -0.498611, -0.455208, 0.152587, -0.0461458, -0.239583, 0.144271, 0.00263889, 0.156736, -0.455208, -1.49694,
            -0.488472, -0.254861, -0.0304601, 0.156736, -0.100833, 0.172014, -0.0359983, 0.152587, -0.488472, -0.598333,
            -0.544028, 0.18033, -0.0545486, -0.289444, 0.172014, 0.00236111, 0.184479, -0.544028, -1.76306, -0.577292,
            -0.304722, -0.0359983, 0.184479, -0.117639, 0.199757, -0.0415365, 0.18033, -0.577292, -0.698056, -0.632847,
            0.208073, -0.0629514, -0.339306, 0.199757, 0.00208333, 0.212222, -0.632847, -2.02917, -0.666111, -0.354583,
            -0.0415365, 0.212222, -0.0727691, 0.208073, -0.666111, -0.379462, -0.0713542, -0.389167,
        };
        var Ig = new[]
        {
            0, 0, 1, 3, 4, 6, 7, 9, 10, 12, 15, 19, 26, 30, 37, 41, 48, 52, 57, 63, 70, 82, 89, 101, 108, 120, 127, 135,
            138, 142, 149, 153, 160, 164, 171, 175, 180, 186, 193, 205, 212, 224, 231, 243, 250, 258, 261, 265, 272,
            276, 283, 287, 294, 298, 303, 309, 316, 328, 335, 347, 354, 366, 373, 381, 384, 388, 395, 399, 406, 410,
            417, 421, 426, 432, 439, 451, 458, 470, 477, 489, 496, 504,
        };
        var Jg = new[]
        {
            0, 0, 1, 2, 2, 3, 4, 4, 5, 6, 6, 7, 0, 1, 2, 0, 1, 2, 9, 0, 1, 2, 3, 4, 9, 10, 2, 3, 4, 11, 2, 3, 4, 5, 6,
            11, 12, 4, 5, 6, 13, 4, 5, 6, 7, 8, 13, 14, 6, 7, 8, 15, 6, 7, 8, 15, 16, 0, 1, 2, 9, 10, 11, 0, 1, 2, 9,
            10, 11, 18, 0, 1, 2, 3, 4, 9, 10, 11, 12, 13, 18, 19, 2, 3, 4, 11, 12, 13, 20, 2, 3, 4, 5, 6, 11, 12, 13,
            14, 15, 20, 21, 4, 5, 6, 13, 14, 15, 22, 4, 5, 6, 7, 8, 13, 14, 15, 16, 17, 22, 23, 6, 7, 8, 15, 16, 17, 24,
            6, 7, 8, 15, 16, 17, 24, 25, 18, 19, 20, 18, 19, 20, 27, 18, 19, 20, 21, 22, 27, 28, 20, 21, 22, 29, 20, 21,
            22, 23, 24, 29, 30, 22, 23, 24, 31, 22, 23, 24, 25, 26, 31, 32, 24, 25, 26, 33, 24, 25, 26, 33, 34, 18, 19,
            20, 27, 28, 29, 18, 19, 20, 27, 28, 29, 36, 18, 19, 20, 21, 22, 27, 28, 29, 30, 31, 36, 37, 20, 21, 22, 29,
            30, 31, 38, 20, 21, 22, 23, 24, 29, 30, 31, 32, 33, 38, 39, 22, 23, 24, 31, 32, 33, 40, 22, 23, 24, 25, 26,
            31, 32, 33, 34, 35, 40, 41, 24, 25, 26, 33, 34, 35, 42, 24, 25, 26, 33, 34, 35, 42, 43, 36, 37, 38, 36, 37,
            38, 45, 36, 37, 38, 39, 40, 45, 46, 38, 39, 40, 47, 38, 39, 40, 41, 42, 47, 48, 40, 41, 42, 49, 40, 41, 42,
            43, 44, 49, 50, 42, 43, 44, 51, 42, 43, 44, 51, 52, 36, 37, 38, 45, 46, 47, 36, 37, 38, 45, 46, 47, 54, 36,
            37, 38, 39, 40, 45, 46, 47, 48, 49, 54, 55, 38, 39, 40, 47, 48, 49, 56, 38, 39, 40, 41, 42, 47, 48, 49, 50,
            51, 56, 57, 40, 41, 42, 49, 50, 51, 58, 40, 41, 42, 43, 44, 49, 50, 51, 52, 53, 58, 59, 42, 43, 44, 51, 52,
            53, 60, 42, 43, 44, 51, 52, 53, 60, 61, 54, 55, 56, 54, 55, 56, 63, 54, 55, 56, 57, 58, 63, 64, 56, 57, 58,
            65, 56, 57, 58, 59, 60, 65, 66, 58, 59, 60, 67, 58, 59, 60, 61, 62, 67, 68, 60, 61, 62, 69, 60, 61, 62, 69,
            70, 54, 55, 56, 63, 64, 65, 54, 55, 56, 63, 64, 65, 72, 54, 55, 56, 57, 58, 63, 64, 65, 66, 67, 72, 73, 56,
            57, 58, 65, 66, 67, 74, 56, 57, 58, 59, 60, 65, 66, 67, 68, 69, 74, 75, 58, 59, 60, 67, 68, 69, 76, 58, 59,
            60, 61, 62, 67, 68, 69, 70, 71, 76, 77, 60, 61, 62, 69, 70, 71, 78, 60, 61, 62, 69, 70, 71, 78, 79,
        };
        var B = new[]
        {
            -0.0416667, 0.00184462, 0.00195312, 0.0061849, 0.00434028, 0.0113932, 0.00716146, 0.0174696, 0.171875,
            -0.166667, 0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, -0.0833333,
            0.00368924, 0.00390625, 0.0123698, 0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.34375, -0.166667,
            0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, -0.0833333,
            0.00368924, 0.00390625, 0.0123698, 0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.34375, -0.166667,
            0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, -0.0833333,
            0.00368924, 0.00390625, 0.0123698, 0.00868056, 0.0227865, 0.0143229, 0.0349392, 0.34375, -0.166667,
            0.00737847, 0.0078125, 0.0247396, 0.0173611, 0.0455729, 0.0286458, 0.0698785, 0.6875, 0, 0.189345, 0.10612,
            0.235352, 0.12934, 0.282227, 0.152995, 0.32997, 0.255208,
        };
        var q = new[]
        {
            1.00001, 1.12499, 1.25001, 1.37499, 1.50001, 1.62499, 1.75001, 1.87499, 2, 1.00001, 1.12499, 1.25001,
            1.37499, 1.50001, 1.62499, 1.75001, 1.87499, 2, 1.00001, 1.12499, 1.25001, 1.37499, 1.50001, 1.62499,
            1.75001, 1.87499, 2, 1.00001, 1.12499, 1.25001, 1.37499, 1.50001, 1.62499, 1.75001, 1.87499, 2.00001,
            1.00001, 1.12499, 1.25001, 1.37499, 1.50001, 1.62499, 1.75001, 1.87499, 2.00001, 1.00001, 1.12499, 1.25001,
            1.37499, 1.50001, 1.62499, 1.75001, 1.87499, 2.00001, 1.00001, 1.12499, 1.25001, 1.37499, 1.50001, 1.62499,
            1.75001, 1.87499, 2.00001, 1.00001, 1.12499, 1.25001, 1.37499, 1.50001, 1.62499, 1.75001, 1.87499, 2.00001,
            1.00001, 1.12499, 1.25001, 1.37499, 1.50001, 1.62499, 1.75001, 1.87499, 2.00001,
        };


        var matrix = new Matrix(Di, Al, Au, Ig, Jg);
        var expected = new Slae(matrix, q, B);
        bool isTimeShem = false;

        var area = JsonSerializer.Deserialize<Area>(
            File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Area.json"))!;
        var boundary =
            JsonSerializer.Deserialize<BoundaryData>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Boundary.json"))!;
        var initial =
            JsonSerializer.Deserialize<Initial>(
                File.ReadAllText("D:/Программы/Cursach 2.0/Cursach 2.0/bin/Debug/net6.0/Data/Initial.json"))!;
        var fem = new Fem(area, boundary,1);
        Boundary.Two(area, fem.Grid, boundary, ref fem.Slae, 0);
        Boundary.Three(area, fem.Grid, boundary, ref fem.Slae, 0);
        Boundary.One(area, fem.Grid, boundary, ref fem.Slae, 0,1);
        var Fac = new double[3][];
        Fac[0] = new double[fem.Slae.A.Di.Length];
        Fac[1] = new double[fem.Slae.A.Al.Length];
        Fac[2] = new double[fem.Slae.A.Au.Length];
        fem.Slae.LUsq(Fac[0], Fac[1], Fac[2]);
        int k = 0;
        double error = 0.0;
        fem.Slae.LoSPrecond(Fac[0], Fac[1], Fac[2], ref fem.Slae.Q, ref k, ref error);

        var result = fem.Slae;

        for (var i = 0; i < expected.A.Di.Length; i++)
        {
            Assert.AreEqual(result.A.Di[i], expected.A.Di[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Al.Length; i++)
        {
            Assert.AreEqual(result.A.Al[i], expected.A.Al[i], 1.0e-4);
        }

        for (var i = 0; i < expected.A.Au.Length; i++)
        {
            Assert.AreEqual(result.A.Au[i], expected.A.Au[i], 1.0e-4);
        }

        for (var i = 0; i < expected.B.Length; i++)
        {
            Assert.AreEqual(result.B[i], expected.B[i], 1.0e-4);
        }

        for (var i = 0; i < expected.Q.Length; i++)
        {
            Assert.AreEqual(result.Q[i], expected.Q[i], 1.0e-4);
        }
    }
}